(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{348:function(v,_,a){v.exports=a.p+"assets/img/application-layer.8012cf36.png"},355:function(v,_,a){"use strict";a.r(_);var t=a(43),l=Object(t.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"java开发手册v1-7-0（嵩山版）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java开发手册v1-7-0（嵩山版）"}},[v._v("#")]),v._v(" Java开发手册v1.7.0（嵩山版）")]),v._v(" "),t("h2",{attrs:{id:"发布说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布说明"}},[v._v("#")]),v._v(" 发布说明")]),v._v(" "),t("p",[v._v("2020年8月3日，阿里巴巴技术团队正式发布《Java开发手册》v1.7.0版本，版本代号：嵩山版。首次发布前后端规约。\n参考： "),t("a",{attrs:{href:"https://developer.aliyun.com/ask/310991",target:"_blank",rel:"noopener noreferrer"}},[v._v("嵩山版《Java开发手册》答开发者问"),t("OutboundLink")],1)]),v._v(" "),t("h2",{attrs:{id:"变更记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变更记录"}},[v._v("#")]),v._v(" 变更记录")]),v._v(" "),t("p",[v._v("根据官方文档描述，本次版本改动点如下：")]),v._v(" "),t("ul",[t("li",[v._v("1）新增前后端规约 14 条。")]),v._v(" "),t("li",[v._v("2）新增禁止任何歧视性用语的约定。")]),v._v(" "),t("li",[v._v("3）新增涉及敏感操作的情况下日志需要保存六个月的约定。")]),v._v(" "),t("li",[v._v("4）修正 BigDecimal 类中关于 compareTo 和 equals 的等值比较。")]),v._v(" "),t("li",[v._v("5）修正 HashMap 关于 1024 个元素扩容的次数。")]),v._v(" "),t("li",[v._v("6）修正架构分层规范与相关说明。")]),v._v(" "),t("li",[v._v("7）修正泰山版中部分格式错误和描述错误。")])]),v._v(" "),t("p",[v._v("为便于快速学习，特将本次变更的核心内容提取出来进行记录，以便大家快速学习。")]),v._v(" "),t("h3",{attrs:{id:"_1-【一、-编程规约】之【-一-命名风格】章节增加避免种族歧视性词语要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-【一、-编程规约】之【-一-命名风格】章节增加避免种族歧视性词语要求"}},[v._v("#")]),v._v(" 1. 【一、 编程规约】之【(一) 命名风格】章节增加避免种族歧视性词语要求")]),v._v(" "),t("blockquote",[t("ol",{attrs:{start:"3"}},[t("li",[v._v("【强制】代码和注释中都要避免使用任何语言的种族歧视性词语。")])]),v._v(" "),t("ul",[t("li",[v._v("正例：日本人 / 印度人 / blockList / allowList / secondary")]),v._v(" "),t("li",[v._v("反例：RIBENGUIZI / Asan / blackList / whiteList / slave")])])]),v._v(" "),t("h3",{attrs:{id:"_2-【一、-编程规约】之【-四-oop-规约】章节增加bigdecimal等值比较要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-【一、-编程规约】之【-四-oop-规约】章节增加bigdecimal等值比较要求"}},[v._v("#")]),v._v(" 2. 【一、 编程规约】之【(四) OOP 规约】章节增加BigDecimal等值比较要求")]),v._v(" "),t("blockquote",[t("p",[v._v("10.【强制】如上所示 BigDecimal 的等值比较应使用 compareTo()方法，而不是 equals()方法。")]),v._v(" "),t("p",[v._v("说明：equals()方法会比较值和精度（1.0 与 1.00 返回结果为 false），而 compareTo()则会忽略精度。")])]),v._v(" "),t("h3",{attrs:{id:"_3-【一、-编程规约】之【-六-集合处理】章节修正-hashmap-关于-1024-个元素扩容的次数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-【一、-编程规约】之【-六-集合处理】章节修正-hashmap-关于-1024-个元素扩容的次数"}},[v._v("#")]),v._v(" 3. 【一、 编程规约】之【(六) 集合处理】章节修正 HashMap 关于 1024 个元素扩容的次数")]),v._v(" "),t("blockquote",[t("ol",{attrs:{start:"17"}},[t("li",[v._v("【推荐】集合初始化时，指定集合初始值大小。")])]),v._v(" "),t("ul",[t("li",[v._v("说明：HashMap 使用 HashMap(int initialCapacity) 初始化，如果暂时无法确定集合大小，那么指定默认值（16）即可。")]),v._v(" "),t("li",[v._v("正例：initialCapacity = (需要存储的元素个数 / 负载因子) + 1。注意负载因子（即 loader factor）默认为 0.75，如果暂时无法确定初始值大小，请设置为 16（即默认值）。")]),v._v(" "),t("li",[v._v("反例： HashMap 需要放置 1024 个元素，由于没有设置容量初始大小，随着元素增加而被迫不断扩容，resize()方法总共会调用 8 次，反复重建哈希表和数据迁移。当放置的集合元素个数达千万级时会影响程序性能。")])])]),v._v(" "),t("h3",{attrs:{id:"_4-【一、-编程规约】增加【-十-前后端规约】"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-【一、-编程规约】增加【-十-前后端规约】"}},[v._v("#")]),v._v(" 4. 【一、 编程规约】增加【(十) 前后端规约】")]),v._v(" "),t("p",[v._v("(十) 前后端规约")]),v._v(" "),t("blockquote",[t("ol",[t("li",[v._v("【强制】前后端交互的 API，需要明确协议、域名、路径、请求方法、请求内容、状态码、响应体。")])]),v._v(" "),t("p",[v._v("说明：")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("1） 协议：生产环境必须使用 HTTPS。")])]),v._v(" "),t("li",[t("p",[v._v("2） 路径：每一个 API 需对应一个路径，表示 API 具体的请求地址：")]),v._v(" "),t("ul",[t("li",[v._v("a） 代表一种资源，只能为名词，推荐使用复数，不能为动词，请求方法已经表达动作意义。")]),v._v(" "),t("li",[v._v("b） URL 路径不能使用大写，单词如果需要分隔，统一使用下划线。")]),v._v(" "),t("li",[v._v('c） 路径禁止携带表示请求内容类型的后缀，比如".json",".xml"，通过 accept 头表达即可。')]),v._v(" "),t("li",[v._v("3） 请求方法：对具体操作的定义，常见的请求方法如下：")]),v._v(" "),t("li",[v._v("a） GET：从服务器取出资源。")]),v._v(" "),t("li",[v._v("b） POST：在服务器新建一个资源。")]),v._v(" "),t("li",[v._v("c） PUT：在服务器更新资源。")]),v._v(" "),t("li",[v._v("d） DELETE：从服务器删除资源。")])])]),v._v(" "),t("li",[t("p",[v._v("4） 请求内容：URL 带的参数必须无敏感信息或符合安全要求；body 里带参数时必须设置 Content-Type。")])]),v._v(" "),t("li",[t("p",[v._v("5） 响应体：响应体 body 可放置多种数据类型，由 Content-Type 头来确定。")])])]),v._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[v._v("【强制】前后端数据列表相关的接口返回，如果为空，则返回空数组[]或空集合{}。")])]),v._v(" "),t("ul",[t("li",[v._v("说明：此条约定有利于数据层面上的协作更加高效，减少前端很多琐碎的 null 判断。")])]),v._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[v._v("【强制】服务端发生错误时，返回给前端的响应信息必须包含 HTTP 状态码，errorCode、errorMessage、用户提示信息四个部分。")])]),v._v(" "),t("ul",[t("li",[v._v("说明：四个部分的涉众对象分别是浏览器、前端开发、错误排查人员、用户。其中输出给用户的提示信息要求：简短清晰、提示友好，引导用户进行下一步操作或解释错误原因，提示信息可以包括错误原因、上下文环境、推荐操作等。 errorCode：参考附表 3。errorMessage：简要描述后端出错原因，便于错误排查人员快速定位问题，注意不要包含敏感数据信息。")]),v._v(" "),t("li",[v._v("正例：常见的 HTTP 状态码如下\n"),t("ul",[t("li",[v._v("1） 200 OK: 表明该请求被成功地完成，所请求的资源发送到客户端。")]),v._v(" "),t("li",[v._v("2） 401 Unauthorized: 请求要求身份验证，常见对于需要登录而用户未登录的情况。")]),v._v(" "),t("li",[v._v("3） 403 Forbidden：服务器拒绝请求，常见于机密信息或复制其它登录用户链接访问服务器的情况。")]),v._v(" "),t("li",[v._v("4） 404 Not Found: 服务器无法取得所请求的网页，请求资源不存在。")]),v._v(" "),t("li",[v._v("5） 500 Internal Server Error: 服务器内部错误。")])])])]),v._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[v._v("【强制】在前后端交互的 JSON 格式数据中，所有的 key 必须为小写字母开始的lowerCamelCase 风格，符合英文表达习惯，且表意完整。")])]),v._v(" "),t("ul",[t("li",[v._v("正例：errorCode / errorMessage / assetStatus / menuList / orderList / configFlag")]),v._v(" "),t("li",[v._v("反例：ERRORCODE / ERROR_CODE / error_message / error-message / errormessage / ErrorMessage / msg")])]),v._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[t("p",[v._v('【强制】errorMessage 是前后端错误追踪机制的体现，可以在前端输出到 type="hidden"文字类控件中，或者用户端的日志中，帮助我们快速地定位出问题。')])]),v._v(" "),t("li",[t("p",[v._v("【强制】对于需要使用超大整数的场景，服务端一律使用 String 字符串类型返回，禁止使用Long 类型。")])])]),v._v(" "),t("ul",[t("li",[v._v("说明：Java 服务端如果直接返回 Long 整型数据给前端，JS 会自动转换为 Number 类型（注：此类型为双精度浮点数，表示原理与取值范围等同于 Java 中的 Double）。Long 类型能表示的最大值是 2 的 63 次方-1，在取值范围之内，超过 2 的 53 次方 (9007199254740992)的数值转化为 JS 的 Number 时，有些数值会有精度损失。扩展说明，在 Long 取值范围内，任何 2 的指数次整数都是绝对不会存在精度损失的，所以说精度损失是一个概率问题。若浮点数尾数位与指数位空间不限，则可以精确表示任何整数，但很不幸，双精度浮点数的尾数位只有 52 位。")]),v._v(" "),t("li",[v._v('反例：通常在订单号或交易号大于等于 16 位，大概率会出现前后端单据不一致的情况，比如，"orderId": 362909601374617692，前端拿到的值却是: 362909601374617660。')])]),v._v(" "),t("ol",{attrs:{start:"7"}},[t("li",[v._v("【强制】HTTP 请求通过 URL 传递参数时，不能超过 2048 字节。")])]),v._v(" "),t("ul",[t("li",[t("p",[v._v("说明：不同浏览器对于 URL 的最大长度限制略有不同，并且对超出最大长度的处理逻辑也有差异，2048字节是取所有浏览器的最小值。")])]),v._v(" "),t("li",[t("p",[v._v("反例：某业务将退货的商品 id 列表放在 URL 中作为参数传递，当一次退货商品数量过多时，URL 参数超长，传递到后端的参数被截断，导致部分商品未能正确退货。")])])]),v._v(" "),t("ol",{attrs:{start:"8"}},[t("li",[v._v("【强制】HTTP 请求通过 body 传递内容时，必须控制长度，超出最大长度后，后端解析会出错。")])]),v._v(" "),t("ul",[t("li",[v._v("说明：nginx 默认限制是 1MB，tomcat 默认限制为 2MB，当确实有业务需要传较大内容时，可以通过调大服务器端的限制。")])]),v._v(" "),t("ol",{attrs:{start:"9"}},[t("li",[t("p",[v._v("【强制】在翻页场景中，用户输入参数的小于 1，则前端返回第一页参数给后端；后端发现用户输入的参数大于总页数，直接返回最后一页。")])]),v._v(" "),t("li",[t("p",[v._v("【强制】服务器内部重定向必须使用 forward；外部重定向地址必须使用 URL 统一代理模块生成，否则会因线上采用 HTTPS 协议而导致浏览器提示“不安全”，并且还会带来 URL 维护不一致的问题。")])]),v._v(" "),t("li",[t("p",[v._v("【推荐】服务器返回信息必须被标记是否可以缓存，如果缓存，客户端可能会重用之前的请求结果。")])])]),v._v(" "),t("ul",[t("li",[v._v("说明：缓存有利于减少交互次数，减少交互的平均延迟。")]),v._v(" "),t("li",[v._v('正例：http 1.1 中，s-maxage 告诉服务器进行缓存，时间单位为秒，用法如下，\nresponse.setHeader("Cache-Control", "s-maxage=" + cacheSeconds);')])]),v._v(" "),t("ol",{attrs:{start:"12"}},[t("li",[v._v("【推荐】服务端返回的数据，使用 JSON 格式而非 XML。")])]),v._v(" "),t("ul",[t("li",[v._v("说明：尽管 HTTP 支持使用不同的输出格式，例如纯文本，JSON，CSV，XML，RSS 甚至 HTML。如果我们使用的面向用户的服务，应该选择 JSON 作为通信中使用的标准数据交换格式，包括请求和响应。此外，application/JSON 是一种通用的 MIME 类型，具有实用、精简、易读的特点。")])]),v._v(" "),t("ol",{attrs:{start:"13"}},[t("li",[v._v('【推荐】前后端的时间格式统一为"yyyy-MM-dd HH:mm:ss"，统一为 GMT。')])]),v._v(" "),t("p",[v._v("14.【参考】在接口路径中不要加入版本号，版本控制在 HTTP 头信息中体现，有利于向前兼容。")]),v._v(" "),t("ul",[t("li",[v._v("说明：当用户在低版本与高版本之间反复切换工作时，会导致迁移复杂度升高，存在数据错乱风险。")])])]),v._v(" "),t("h3",{attrs:{id:"_5-删除【二、异常日志】之【-二-异常处理】章节的-dry原则-要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-删除【二、异常日志】之【-二-异常处理】章节的-dry原则-要求"}},[v._v("#")]),v._v(" 5. 删除【二、异常日志】之【(二) 异常处理】章节的“DRY原则”要求")]),v._v(" "),t("blockquote",[t("p",[t("s",[v._v("14. 【参考】避免出现重复的代码（Don't Repeat Yourself），即 DRY 原则。")])]),v._v(" "),t("ul",[t("li",[t("s",[v._v("说明：随意复制和粘贴代码，必然会导致代码的重复，在以后需要修改时，需要修改所有的副本，容易遗漏。必要时抽取共性方法，或者抽象公共类，甚至是组件化。")])]),v._v(" "),t("li",[t("s",[v._v("正例：一个类中有多个 public 方法，都需要进行数行相同的参数校验操作，这个时候请抽取：")]),v._v(" "),t("s",[v._v("private boolean checkParam(DTO dto) {...}")])])])]),v._v(" "),t("h3",{attrs:{id:"_6-【二、异常日志】之【-三-日志规约】增加日志留存要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-【二、异常日志】之【-三-日志规约】增加日志留存要求"}},[v._v("#")]),v._v(" 6.【二、异常日志】之【(三) 日志规约】增加日志留存要求")]),v._v(" "),t("blockquote",[t("ol",{attrs:{start:"3"}},[t("li",[v._v("【强制】根据国家法律，网络运行状态、网络安全事件、个人敏感信息操作等相关记录，留存的日志不少于六个月，并且进行网络多机备份。")])])]),v._v(" "),t("h3",{attrs:{id:"_7-【六、工程结构】之【-一-应用分层】修改架构分层描述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-【六、工程结构】之【-一-应用分层】修改架构分层描述"}},[v._v("#")]),v._v(" 7. 【六、工程结构】之【(一) 应用分层】修改架构分层描述")]),v._v(" "),t("blockquote",[t("ol",[t("li",[v._v("【推荐】根据业务架构实践，结合业界分层规范与流行技术框架分析，推荐分层结构如图所示，默认上层依赖于下层，箭头关系表示可直接依赖，如：开放 API 层可以依赖于 Web 层（Controller 层），也可以直接依赖于 Service 层，依此类推：")])]),v._v(" "),t("ul",[t("li",[t("p",[t("img",{attrs:{src:a(348),alt:""}})])]),v._v(" "),t("li",[t("p",[v._v("开放 API 层：可直接封装 Service 接口暴露成 RPC 接口；通过 Web 封装成 http 接口；网关控制层等。")])]),v._v(" "),t("li",[t("p",[v._v("终端显示层：各个端的模板渲染并执行显示的层。当前主要是 velocity 渲染，JS 渲染，JSP 渲染，移动端展示等。")])]),v._v(" "),t("li",[t("p",[v._v("Web 层：主要是对访问控制进行转发，各类基本参数校验，或者不复用的业务简单处理等。")])]),v._v(" "),t("li",[t("p",[v._v("Service 层：相对具体的业务逻辑服务层。")])]),v._v(" "),t("li",[t("p",[v._v("Manager 层：通用业务处理层，它有如下特征：")]),v._v(" "),t("ul",[t("li",[v._v("1） 对第三方平台封装的层，预处理返回结果及转化异常信息，适配上层接口。")]),v._v(" "),t("li",[v._v("2） 对 Service 层通用能力的下沉，如缓存方案、中间件通用处理。")]),v._v(" "),t("li",[v._v("3） 与 DAO 层交互，对多个 DAO 的组合复用。")])])]),v._v(" "),t("li",[t("p",[v._v("DAO 层：数据访问层，与底层 MySQL、Oracle、Hbase、OB 等进行数据交互。")])]),v._v(" "),t("li",[t("p",[v._v("第三方服务：包括其它部门 RPC 服务接口，基础平台，其它公司的 HTTP 接口，如淘宝开放平台、支付宝付款服务、高德地图服务等。")])]),v._v(" "),t("li",[t("p",[v._v("外部数据接口：外部（应用）数据存储服务提供的接口，多见于数据迁移场景中。")])])])])])}),[],!1,null,null,null);_.default=l.exports}}]);